

# üçáProject 1: Wild Blueberry Yield Prediction




![image](https://user-images.githubusercontent.com/70902291/170817044-e4ebea33-1864-4756-8d51-1fa01a7df24e.png)

              Image Source
 https://fruitgrowersnews.com/news/blueberry-production-expected-surpass-1-4-billion-lbs/

# üßæDescription: 
```

The dataset used for predictive modelling was generated by the Wild Blueberry Pollination Simulation Model, 
which is an open-source, spatially-explicit computer simulation program, that enables exploration of how various factors,
including plant spatial arrangement, outcrossing and self-pollination, bee species compositions and weather conditions,
in isolation and combination, affect pollination efficiency and yield of the wild blueberry agro-ecosystem. 

The simulation model has been validated by the field observation and experimentaldata collected in Maine USA and Canadian
Maritimes during the last 30 years and now is a useful tool for hypothesis testing and theory development for wild blueberry
pollination researches. This simulated data provides researchers who have actual data collected from field observation and those 
who wants to experiment the potentialof machine learning algorithms response to real data and computer simulation modelling 
generated data as input for crop yield prediction models.


```
## Task 1: Exploratory Data Analysis

Exploratory Data Analysis is the first step of understanding your data and acquiring domain knowledge. It helps in knowing the real features apart. 
Perform EDA using the following resources and note down your insights with most visualizations that you perform.

Links To Refer

1-  [Data Visualization using Matplotlib](https://towardsdatascience.com/data-visualization-using-matplotlib-16f1aae5ce70)

2-  [Matplotlib cheet sheet](http://datacamp-community-prod.s3.amazonaws.com/e1a8f39d-71ad-4d13-9a6b-618fe1b8c9e9)

3- [The Art of Effective Visualization of Multi-dimensional Data](https://towardsdatascience.com/the-art-of-effective-visualization-of-multi-dimensional-data-6c7202990c57)

### Import Data And Preprocessing:

According to data dictionary, we have 3 unknown fields. If the regression is a multivariate problem, then fruitset, 
fruitmass, seeds will be the part of target variables. otherwise, we'll focus on predicting the yield value.

we have a data dictionary of mutual correlated values of each of the fields with yield values
as this clearly is a regression problem, we can perform feature selection on the data
there are the following approaches:
- f_regression() parameter for selecting by correlation
- mutual_info_regression() for selecting by information gain
- raw data features kept intact

Important Care while Going Through Dataset 
Check For:

- Are There any constant ,values repeating itself again and again .
- Are There any pseudo Null
- Check for skewness
- Absolute Null

![image](https://user-images.githubusercontent.com/70902291/170814863-e3ec4247-df01-42dc-9656-bcfaf6879b1d.png)

#### Clearly we can see that in honeybee column Maximum value os 18.43 and 50 % values are around .25 and minimum is zero we can say it act like outlier.

## Univariate Analysis
We have no null values, and overall dtype of the dataset is float So the next step will be Preprocessing.

![image](https://user-images.githubusercontent.com/70902291/170815768-e73e8de5-afaf-41a4-a4c2-b98fc0e6f929.png)
 Yield value is centred around 6100 

## Box Plot 
![image](https://user-images.githubusercontent.com/70902291/170816015-a662fddb-916d-4e10-84d4-9438cd00c540.png)

![image](https://user-images.githubusercontent.com/70902291/170815928-e2796322-45b4-47e7-a3ba-5618275f5f16.png)






## Multivariate Analysis

![image](https://user-images.githubusercontent.com/70902291/170815051-bae6aeb3-7ded-4b3b-bcfd-c92a48f82373.png)

##### Note :

![image](https://user-images.githubusercontent.com/70902291/170815094-1cc440ad-412f-45be-a313-dc2770420be1.png)


We can clearly see that  Yield is having very high corelation with the fritset ,fruitmass,seed this may lead to multicollinearity problem ao we will drop some columns.



## Task 2 Preprocessing

We are dropping few columns

columns to drop: 'Row#', 'MaxOfUpperTRange', 'MinOfUpperTRange', 'MaxOfLowerTRange', 'MinOfLowerTRange', 'RainingDays', 'honeybee'

Using Z-score and IQR:
Outlier Detection 

- http://colingorrie.github.io/outlier-detection.html
- https://towardsdatascience.com/ways-to-detect-and-remove-the-outliers-404d16608dba
- https://towardsdatascience.com/z-score-for-anomaly-detection-d98b0006f510

## Box Plot aftyer applying IQR 
![image](https://user-images.githubusercontent.com/70902291/170816185-89a33914-5175-4434-94e3-33e4f15510f1.png)
![image](https://user-images.githubusercontent.com/70902291/170816200-7b92e62a-4032-4f1d-82b5-b57a3ec66f0d.png)


 
 
## Box Plot after applying Z score :
![image](https://user-images.githubusercontent.com/70902291/170816216-6df3c036-f4e9-4b28-b2fa-a1ba1f440110.png)
![image](https://user-images.githubusercontent.com/70902291/170816235-a47fac0b-fa8f-4626-931c-36746552916e.png)



As above we can see most of outliers are removed only few are left but there effect is very minimal.



## Task 3: Feature Selection



We have created 2 splits on Dataset, and each will be analysed on the importance of either Mutual Information gain or Correlation Regression values.

- Taking Corelation Regression as an important method to analyze 

![image](https://user-images.githubusercontent.com/70902291/170815376-80e544ee-0d9f-43ef-a839-94fdc16ff87d.png)

 we can clearly see that values are shooting up in certain Features like 7,8,9
 
 
 - Taking Information gain as an important method to analyze 
 
 ![image](https://user-images.githubusercontent.com/70902291/170815527-6c867406-e107-4bd0-8315-e99e99d26078.png)


 


## Task 4: Modelling 


We will now train the model on top 9 features, using both the splits of dataset,
and check the metrics of the same on 4 Models

- Linear Regression
- Random Forest
- Decision Tree
- XGBoost

![image](https://user-images.githubusercontent.com/70902291/170815577-f4a5671d-a39a-40f0-b84e-c4bf5397674f.png)



## Task 5: Hyperparameter Tuning 
crossvalidation, RepeatedKFold and GridSearchCV are the popular methods for Parameter Tuning

We have only tuned the model for K values, plus an addition model parameter. With greater processor, 
the tuning can afford to produce folds 3 times over 4 parameter values

Another alternative is: TuneSearchCV
## Prediction and Evaluation¬∂
Running the GridSearchCV and saving the best model.

Note - Although Linear Regression is the best of the listed models, RandomForest would potentially produce closer precise results,
due to good learning rate,hence I would retune it in addition to the best params extracted in the first search.

![image](https://user-images.githubusercontent.com/70902291/170815673-82289256-d3e9-4e57-8628-394b4d0b718d.png)

We have Taken here best Model and saved it for further analysis.


## **DEPLOYMENT USING STREAMLIT üöÄ**

- 1\. Download streamlit in your environment using pip.
- 2\. Prepare python files, to process the user data and return prediction, and one for the streamlit code for the Front End
- 3.Prepare files that would be useful for deploying on Heroku: Procfile, setup.sh, requirements.txt, runtime.txt
- 4.Make a new repository on GitHub and push the project folder containing all of the folders into the repository
- 5.Goto Heroku and Log-in. Create a new app, and give it a name
- 6\. In the "Deploy" section of this new app, choose "GitHub"
- 7\. in the next section, search for your app by the exact name, and click on "connect" to connect the app
- 8\. Once connected, scroll down to manual deployment, and Click on deploy
- 9\. if the above said procedures are followed, the build logs will show your deployed URL at the end



üìå Creating "requirements.txt":

- GoTo your project folder and open command prompt in that folder.
- install pipreqs package using "pip install pipreqs"
- then type this command: for requirements.txt: pipreqs --encoding=utf8  --debug  "path/to/project". *Don't forget to add absolute path above inside inverted commas*

üìå Streamlit docs: https://docs.streamlit.io/en/stable/

## Application Created using Streamlit

![image](https://user-images.githubusercontent.com/70902291/170816370-819a1e5b-6142-4665-a73d-dcc1f01f4d34.png)

 We Have used Model Expainable AI using shap Values 
 
 Clearly we can see That Red features like osmia ,fruitset are having positive effects on our output.
 
## Explainable AI
To address the business problems and work upon robustness of the model, as well as expand the scope of the project

Shap References:

https://shap.readthedocs.io/en/latest/example_notebooks/tabular_examples/tree_based_models/Front%20page%20example%20%28XGBoost%29.html

https://towardsdatascience.com/shap-explained-the-way-i-wish-someone-explained-it-to-me-ab81cc69ef30

https://towardsdatascience.com/explainable-ai-xai-with-shap-multi-class-classification-problem-64dd30f97cea

![image](https://user-images.githubusercontent.com/70902291/170816898-1b201861-ffd0-44cd-83d3-b5cf84c99623.png)

We can see if the fruitset value decreases, it doesn't affect the yield value, while if it increases, it will overpower the other impacts

Other features has comparitively high tolerance value. If there is -1 rainy days, then it will have a higher value, while for range of +/-2, the impact drops low.

![image](https://user-images.githubusercontent.com/70902291/170816923-64f4f37a-49ac-45ce-9cdb-5a0fc5c4685b.png)

![image](https://user-images.githubusercontent.com/70902291/170816953-9882b25f-678b-4a99-8005-ce8022ff0c85.png)

We can check how the  different features are effecting for Yield Output.
Note- Above Steps are Done only aftyer We have Trained And saved best model for our Problem.


## How To Run The Application
```
Open the project in the command line go to particular folder which have app.py

run the command
streamlit run app.py 

```
# Cloud Deploymeny using Heruku'

Install the Heroku CLI

Download and install the [Heroku CLI]( https://devcenter.heroku.com/articles/heroku-cli)

If you haven't already, log in to your Heroku account and follow the prompts to create a new SSH public key.

```
$ heroku login

```
Clone the repository

```

Use Git to clone blueberry1990's source code to your local machine.

$ heroku git:clone -a blueberry1990 
$ cd blueberry1990
```

Deploy your changes
Make some changes to the code you just cloned and deploy them to Heroku using Git.

```

$ git add .
$ git commit -am "make it better"
$ git push heroku master

```





üìå Guide to adding files on Github:

- https://docs.github.com/en/github/managing-files-in-a-repository/managing-files-on-github/adding-a-file-to-a-repository
- video: https://www.youtube.com/watch?v=vbQ2bYHxxEA\&ab\_channel=StudyZone



